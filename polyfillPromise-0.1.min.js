// version 0.1
// polyfill ES6 Promise in older browsers
// Stephen Giles. https://github.com/ingenious
// API: https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise

(function(){var newAble,PolyfillPromise,root=this;if(root.Promise&&typeof root.Promise=="function")newAble=new root.Promise(function(){});if(!newAble||!root.Promise.all||!root.Promise.race||!root.Promise.reject||!root.Promise.resolve||!newAble.then||!newAble["catch"]){PolyfillPromise=function Promise(a){var b=this,d=[],e,m=[],h,g="pending",k,l,n=function(d){e=arguments;for(var f=0;f<m.length;f++)m[f].apply(b,e);g="rejected"},p=function(a){h=arguments;for(var f=0;f<d.length;f++)d[f].apply(b,h);g="fulfilled"};
if("function"===typeof a)try{a(p,n)}catch(q){g="rejected",e=[q]}else throw Error("Promise argument "+a+" is not a function");b.then=function(a,f){if("fulfilled"===g&&"function"===typeof a)return Promise.resolve(a.apply(b,h));if("rejected"===g&&"function"===typeof f)return Promise.reject(f.apply(b,e));"function"===typeof f&&m.push(function(){l(f.apply(b,e))});"function"===typeof a&&(d[d.length]=function(){l(a.apply(b,h))});return new PolyfillPromise(function(b){l=b})};b["catch"]=function(a){if("rejected"===
g&&"function"===typeof a)return PolyfillPromise.reject(a.apply(b,e));if("fulfilled"===g)return PolyfillPromise.resolve(h);"function"===typeof a&&m.push(function(){k(a.apply(b,e))});return new PolyfillPromise(function(a){k=a})}};PolyfillPromise.all=function(c){return new PolyfillPromise(function(a,b){var d,e=[],m=0,h=c.length;(function k(l){var n=l;c[n].then(function(b){e[n]=b;++m===h&&(d="fulfilled",a(e))});c[n]["catch"](function(a){d||(d="rejected",b(a))});l<h-1&&k(++l)})(0)})};PolyfillPromise.race=
function(c){return new PolyfillPromise(function(a,b){var d,e=c.length;(function h(g){var k=g;c[k].then(function(b){d||(d="fulfilled",a(b))});c[k]["catch"](function(a){d||(d="rejected",b(a))});g<e-1&&h(++g)})(0)})};PolyfillPromise.resolve=function(c){return c&&c.constructor&&c.constructor===PolyfillPromise?c:c&&"function"===typeof c.then?new PolyfillPromise(function(a,b){c.then(a,b)}):new PolyfillPromise(function(a,b){a(c)})};PolyfillPromise.reject=function(c){return new PolyfillPromise(function(a,
b){b(c)})}}else{newAble=null;PolyfillPromise=root.Promise}if(root.define&&root.define.amd&&typeof root.define==="function")define([],function(){return PolyfillPromise});else if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=PolyfillPromise;exports.Promise=PolyfillPromise}else if(!root.Promise)root.Promise=PolyfillPromise})();